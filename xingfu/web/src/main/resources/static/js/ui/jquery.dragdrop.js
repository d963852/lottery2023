(function(a){a.fn.DragDrop=function(b){var d=a.extend({zIndex:20,opacity:0.7,handler:null,onMove:function(){},onDrop:function(){}},b);var c={drag:function(g){if(!g){g=window.event}var f=g.data.dragData;f.target.css({left:f.left+g.pageX-f.offLeft,top:f.top+g.pageY-f.offTop});f.handler.css({cursor:"move"});f.onMove(g)},drop:function(g){if(!g){g=window.event}var f=g.data.dragData;if(f.target.releaseCapture){f.target.releaseCapture()}else{if(window.captureEvents){window.captureEvents(Event.MOUSEMOVE|Event.MOUSEUP)}}f.target.css(f.oldCss);f.handler.css("cursor","move");f.onDrop(g);a(document).unbind("mousemove",c.drag).unbind("mouseup",c.drop)}};return this.each(function(){var f=this;var e=null;if(typeof(d.handler)=="undefined"||d.handler==null){e=a(f)}else{e=(typeof(d.handler)=="string"?a(d.handler,this):d.handle)}e.bind("mouseover",function(){a(this).css({cursor:"move"})});e.bind("mousedown",{e:f},function(i){var m=a(i.data.e);var g=m.offset();var j={left:g.left,top:g.top};if(m.css("position")!="absolute"){try{m.css(j)}catch(h){}m.css("position","absolute")}var l={};i.preventDefault();if(m.setCapture){m.setCapture()}else{if(window.captureEvents){window.captureEvents(Event.MOUSEMOVE|Event.MOUSEUP)}}l.cursor=m.css("cursor")||"default";l.opacity=m.css("opacity")||1;var k={left:parseInt((j.left||m.css("left")||0),10),top:parseInt((j.top||m.css("top")||0),10),width:m.width()||m.css("width"),height:m.height()||m.css("height"),offLeft:i.pageX,offTop:i.pageY,oldCss:l,onMove:d.onMove,onDrop:d.onDrop,handler:e,target:m};m.css("opacity",d.opacity);a(document).bind("mousemove",{dragData:k},c.drag).bind("mouseup",{dragData:k},c.drop)})})}})(jQuery);